---
layout: single
title:  "6 Week"
categories: TIL
tag: [Tomcat, Filter, Web, Session, OSI 7계층, TCP / UDP, Bulk 처리, SSR, CSR]
author_profile: false
toc: true
toc_label: "TIL"
toc_sticky: true
# toc_icon: "heart"  # corresponding Font Awesome icon name (without fa prefix)
---
<br><br><br>



# Web
Web의 정의를 물어보면 뭐라고 답하기 애매하다. 간단하게 한번 짚고 넘어가자
<br>
<br>
<br>
**World Wide Web**
<br>
<br>
인터넷에 연결된 사용자들이 서로의 정보를 공유할 수 있는 공간

* 텍스트, 그림, 소리, 영상 등의 멀티미디어 정보를 하이퍼텍스트 방식으로 연결
	* 하이퍼텍스트 : 문서 내부에 또다른 문서가 연결되는 참조를 넣음


웹페이지들은 각각 연결되어 있는데 이로 인해 거미줄처럼 얽혀있는 정보의 모음이라고도 불림

<br>

**웹페이지**
<br>
<br>
정보제공을 목적으로한 `정적`인 사이트
<br>
수동적으로 정보를 관람함

<br>

**웹어플리케이션**
<br>
<br>
`동적`기능을 가진 웹으로 상호작용을 통해 유저가 
<br>
능동적으로 어플리케이션 상의 서비스를 이용하는것을 목적으로 함

<br>
<br>
<br>
<br>

# Browser Rendering

<br>

## SSR
**서버사이드 렌더링 - Server Side Rendering**
<br>
서버로부터 완전하게 만들어진 `HTML` 파일을 받아와 페이지 전체를 렌더링 하는 방식
<br>
* **동작**
1. 클라이언트가 초기화면을 로드하기 위해 서버에 요청을 보냄
2. 서버는 화면에 표시하는데 필요한 데이터를 모두 얻어와 삽입하고 `CSS` 까지 적용해서 렌더링 준비를 마친 `HTML`과 `JS` 코드를 브라우저에 응답
3. 브라우저에서 전달받은 페이지를 띄우고, `JS` 코드를 다운로드하고 `HTML` 에 실행시킴
<br>
<br>
* **장점**
	* 빠른 초기 로딩
<br>
<br>
* **단점**
	* 요청시마다 새로고침 (깜빡임)
	* 서버부하 (작은 변경이라도 서버에서 모든걸 다시 받아옴)

<br>

## CSR
**클라이언트 사이드 렌더링 - Client Side Rendering**
<br>
사용자에 요청에 따라 필요한 부분만 응답받아 렌더링 하는 방식
<br>
* **동작**
1. 클라이언트에서 초기화면을 로드하기 위해 서버에 요청을 보냄
2. 서버는 화면에 표시하는데 필요한 완전한 리소스 응답
<br>
<br>
* **장점**
	* 빠른속도 (초기화면 렌더링X)
	* 서버부하 감소 (클라이언트에서 변경부분만 요청)
	* 유저경험 증가 (깜빡임)
<br>
<br>
* **단점**
	* 초기화면 로딩 느림 (모든 `JS`파일 받아와야 됨)

<br>
<br>
<br>
<br>

# HTTP의 전송방식
http는 왜 전송방식으로 텍스트를 사용했을까?
* 텍스트는 눈으로 보고 해석할 수 있고
* 다양한 환경에 맞는 (범용적, 유연함) 규약이 필요해서 - 텍스트가 가장 보편적이었다
* 웹의 뜻은 월드 와이드 웹 -> 말그대로 월드, 엄청나게 많은 곳에서 쓰인다

<br>

**HTTPS?**
* 텍스트는 읽기쉬우니까 보안책이 필요하자나
	* 암호화 / 복호화에 필요한 인증서를 포함

<br>
<br>
<br>
<br>

# base64
* 텍스트 배열로 바꾼다?

<br>
<br>
<br>
<br>

# Bulk 처리
대량의 데이터를 한번의 트랜잭션으로 삽입하는 방법이다.
<br>
<br>
insert 로 예를들면
<br>
`MyBatis` 기준 insert 구문 수행 시 values 리스트를 다중으로 사용한다.
<br>

```sql
insert into A values(a, b, c), (a, b, c), (a, b, c) ...


insert into A(a, b, c) values
<foreach collection="list" item="item" separator=",">
	#{item}
</foreach>
```

<br>

**왜쓰는데?**
<br>
<br>
DB와의 트랜잭션은 커넥션을 열고 닫는 등의 생각보다 복잡하고 리소스가 큰데 10000건의 데이터를 
<br>
저장하는 경우를 생각해 보면 데이터를 저장하는데 10000번의 트랜잭션이 일어나게 된다.
<br>
하지만 `bulk insert` 의 경우 단 한번의 트랜잭션으로 처리를 할 수 있기 때문에
<br>
데이터 수가 많을수록 비약적으로 성능이 향상된다.
<br>
실제로도 예전에 거의 안쓰이는 스케쥴러 처리한 `insert` 용도의 `API` 가 있는데 어느순간
<br>
급격히 사용량이 많아져서 데이터 처리에 딜레이가 발생하는 상황이 생긴적이 있는데
<br>
이때 `bulk` 처리 하나로 비약적인 성능향상과 이슈를 해결한 적이 있었다.
<br>
물론 신경써야할 것도 있는데 그건 아래 단점에서..

<br>
<br>

**단점**
<br>
<br>
`bulk insert` 로 10000건의 데이터를 insert 하던 중 마지막 `low` 에서 에러가 발생한다면?
<br>
이럴경우 모두 롤백된다.
<br>
<br>
10000번의 트랜잭션을 1번의 트랜잭션으로 해결해서 비약적인 성능향상을 가져올 수 있지만 하나라도 
<br>
실패하는 순간 트랜잭션은 롤백되고 그 트랜잭션 안에 10000건이 있기 때문에 이렇게 되면 매우 비효율적이다.
<br>
그래서 너무 대량의 데이터를 `bulk` 처리 하는건 좋지않고,
<br>
실패할 경우를 대비해 `retry` 하는 코드도 별도로 짜주는게 좋다.
<br>
제일 좋은건 정합성이 뛰어난 데이터여서 실패할 가능성이 거의 없을때 사용하는게 좋겠다.

<br>
<br>
<br>
<br>

# To Do

<br>
<br>
<br>
<br>

# 세션이 왜필요할까?
쿠키도 있는데 말이야..

<br>
<br>
<br>
<br>

# Tomcat

<br>
<br>
<br>
<br>

# Filter

<br>
<br>
<br>
<br>

# ServletContextListener

<br>
<br>
<br>
<br>

# TCP / UDP

<br>
<br>
<br>
<br>

# OSI 7 계층
계층이 올라간다는건 무슨 의미일까?
<br>
<br>
TCP 기반의 HTTP가 UDP통신을 도입하고 있는데 과연 데이터 정합성의 문제는?

* 데이터 정합성의 검증을 한 계층 더 올려서 거기서 한다는데?
* 그러니까 TCP를 사용하는 계층에선 정합성의 문제에서 자유로우니 UDP 통신을 이용한다?

<br>
<br>
<br>
<br>


<br>